#!/usr/bin/env bash
set -Eeuo pipefail
IFS=$'\n\t'
ROOT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/../.." && pwd)"
DIST_DIR="$ROOT_DIR/scripts/bin/claude-dist"
ENTRY="$DIST_DIR/node_modules/@anthropic-ai/claude-code/cli.js"
CONFIG_DIR_DEFAULT="$ROOT_DIR/state/agents/claude-config"
if [[ ! -f "$ENTRY" ]]; then
  echo "claude CLI не установлен — выполните agentcall agents install" >&2
  exit 1
fi
if [[ -z "${CLAUDE_CONFIG_DIR:-}" ]]; then
  CLAUDE_CONFIG_DIR="$CONFIG_DIR_DEFAULT"
fi
mkdir -p "$CLAUDE_CONFIG_DIR"
export CLAUDE_CONFIG_DIR
exec node "$ENTRY" "$@"
